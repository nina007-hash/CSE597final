2024-12-12 10:51:58,660 -  INFO: The log file is ./outputs/MeaCap_image_example_memory_coco_lmTrainingCorpus_CBART_COCO_0.1_0.8_0.2_k200.log
2024-12-12 10:51:58,660 -  INFO: Namespace(seed=0, gpu='0', batch_size=1, conzic_sample=True, conzic_top_k=200, alpha=0.1, beta=0.8, gamma=0.2, use_prompt=False, prompt=['The image depicts that'], prompt_ensembling=False, use_memory=True, memory_id='coco', memory_caption_path='data/memory/coco/memory_captions.json', memory_caption_num=5, img_path='./image_example', output_path='./outputs', vl_model='G:/HuggingFace/clip-vit-base-patch32', parser_checkpoint='G:/HuggingFace/flan-t5-base-VG-factual-sg', wte_model_path='G:/HuggingFace/all-Mini-L6-v2', lm_model_path='./checkpoints/CBART_COCO', bart='large', refinement_steps=10, adaptive=False, max_refinement_steps=30, max_len=20, min_len=10, temperature=1, repetition_penalty=2, threshold=0, top_k=0, top_p=0.9, decoder_chain=1, do_sample=0, encoder_loss_type=0, insert_mode=0, max_insert_label=1, num_labels=3, generate_mode=0, full_mask=0, w=1.0)
2024-12-12 10:52:25,660 -  INFO: Load BartForTextInfill from the checkpoint ./checkpoints/CBART_COCO.
2024-12-12 11:01:49,668 -  INFO: The log file is ./outputs/MeaCap_image_example_memory_coco_lmTrainingCorpus_CBART_COCO_0.1_0.8_0.2_k200.log
2024-12-12 11:01:49,668 -  INFO: Namespace(seed=0, gpu='0', batch_size=1, conzic_sample=True, conzic_top_k=200, alpha=0.1, beta=0.8, gamma=0.2, use_prompt=False, prompt=['The image depicts that'], prompt_ensembling=False, use_memory=True, memory_id='coco', memory_caption_path='data/memory/coco/memory_captions.json', memory_caption_num=5, img_path='./image_example', output_path='./outputs', vl_model='checkpoints/HuggingFace/clip-vit-base-patch32', parser_checkpoint='G:/HuggingFace/flan-t5-base-VG-factual-sg', wte_model_path='G:/HuggingFace/all-Mini-L6-v2', lm_model_path='./checkpoints/CBART_COCO', bart='large', refinement_steps=10, adaptive=False, max_refinement_steps=30, max_len=20, min_len=10, temperature=1, repetition_penalty=2, threshold=0, top_k=0, top_p=0.9, decoder_chain=1, do_sample=0, encoder_loss_type=0, insert_mode=0, max_insert_label=1, num_labels=3, generate_mode=0, full_mask=0, w=1.0)
2024-12-12 11:02:08,940 -  INFO: Load BartForTextInfill from the checkpoint ./checkpoints/CBART_COCO.
2024-12-12 11:02:10,902 -  INFO: Load CLIP from the checkpoint checkpoints/HuggingFace/clip-vit-base-patch32.
2024-12-12 11:22:21,377 -  INFO: The log file is ./outputs/MeaCap_image_example_memory_coco_lmTrainingCorpus_CBART_COCO_0.1_0.8_0.2_k200.log
2024-12-12 11:22:21,377 -  INFO: Namespace(seed=0, gpu='0', batch_size=1, conzic_sample=True, conzic_top_k=200, alpha=0.1, beta=0.8, gamma=0.2, use_prompt=False, prompt=['The image depicts that'], prompt_ensembling=False, use_memory=True, memory_id='coco', memory_caption_path='data/memory/coco/memory_captions.json', memory_caption_num=5, img_path='./image_example', output_path='./outputs', vl_model='checkpoints/HuggingFace/clip-vit-base-patch32', parser_checkpoint='checkpoints/HuggingFace/flan-t5-base-VG-factual-sg', wte_model_path='checkpoints/HuggingFace/all-MiniLM-L6-v2', lm_model_path='./checkpoints/CBART_COCO', bart='large', refinement_steps=10, adaptive=False, max_refinement_steps=30, max_len=20, min_len=10, temperature=1, repetition_penalty=2, threshold=0, top_k=0, top_p=0.9, decoder_chain=1, do_sample=0, encoder_loss_type=0, insert_mode=0, max_insert_label=1, num_labels=3, generate_mode=0, full_mask=0, w=1.0)
2024-12-12 11:22:40,707 -  INFO: Load BartForTextInfill from the checkpoint ./checkpoints/CBART_COCO.
2024-12-12 11:22:43,164 -  INFO: Load CLIP from the checkpoint checkpoints/HuggingFace/clip-vit-base-patch32.
2024-12-12 11:23:23,607 -  INFO: The log file is ./outputs/MeaCap_image_example_memory_coco_lmTrainingCorpus_CBART_COCO_0.1_0.8_0.2_k200.log
2024-12-12 11:23:23,607 -  INFO: Namespace(seed=0, gpu='0', batch_size=1, conzic_sample=True, conzic_top_k=200, alpha=0.1, beta=0.8, gamma=0.2, use_prompt=False, prompt=['The image depicts that'], prompt_ensembling=False, use_memory=True, memory_id='coco', memory_caption_path='data/memory/coco/memory_captions.json', memory_caption_num=5, img_path='./image_example', output_path='./outputs', vl_model='./checkpoints/HuggingFace/clip-vit-base-patch32', parser_checkpoint='./checkpoints/HuggingFace/flan-t5-base-VG-factual-sg', wte_model_path='./checkpoints/HuggingFace/all-MiniLM-L6-v2', lm_model_path='./checkpoints/CBART_COCO', bart='large', refinement_steps=10, adaptive=False, max_refinement_steps=30, max_len=20, min_len=10, temperature=1, repetition_penalty=2, threshold=0, top_k=0, top_p=0.9, decoder_chain=1, do_sample=0, encoder_loss_type=0, insert_mode=0, max_insert_label=1, num_labels=3, generate_mode=0, full_mask=0, w=1.0)
2024-12-12 11:23:43,039 -  INFO: Load BartForTextInfill from the checkpoint ./checkpoints/CBART_COCO.
2024-12-12 11:23:45,707 -  INFO: Load CLIP from the checkpoint ./checkpoints/HuggingFace/clip-vit-base-patch32.
2024-12-12 11:27:31,221 -  INFO: The log file is ./outputs/MeaCap_image_example_memory_coco_lmTrainingCorpus_CBART_COCO_0.1_0.8_0.2_k200.log
2024-12-12 11:27:31,222 -  INFO: Namespace(seed=0, gpu='0', batch_size=1, conzic_sample=True, conzic_top_k=200, alpha=0.1, beta=0.8, gamma=0.2, use_prompt=False, prompt=['The image depicts that'], prompt_ensembling=False, use_memory=True, memory_id='coco', memory_caption_path='data/memory/coco/memory_captions.json', memory_caption_num=5, img_path='./image_example', output_path='./outputs', vl_model='./checkpoints/HuggingFace/clip-vit-base-patch32', parser_checkpoint='./checkpoints/HuggingFace/flan-t5-base-VG-factual-sg', wte_model_path='./checkpoints/HuggingFace/all-Mini-L6-v2', lm_model_path='./checkpoints/CBART_COCO', bart='large', refinement_steps=10, adaptive=False, max_refinement_steps=30, max_len=20, min_len=10, temperature=1, repetition_penalty=2, threshold=0, top_k=0, top_p=0.9, decoder_chain=1, do_sample=0, encoder_loss_type=0, insert_mode=0, max_insert_label=1, num_labels=3, generate_mode=0, full_mask=0, w=1.0)
2024-12-12 11:27:50,821 -  INFO: Load BartForTextInfill from the checkpoint ./checkpoints/CBART_COCO.
2024-12-12 11:27:53,157 -  INFO: Load CLIP from the checkpoint ./checkpoints/HuggingFace/clip-vit-base-patch32.
2024-12-12 11:28:57,992 -  INFO: The log file is ./outputs/MeaCap_image_example_memory_coco_lmTrainingCorpus_CBART_COCO_0.1_0.8_0.2_k200.log
2024-12-12 11:28:57,992 -  INFO: Namespace(seed=0, gpu='0', batch_size=1, conzic_sample=True, conzic_top_k=200, alpha=0.1, beta=0.8, gamma=0.2, use_prompt=False, prompt=['The image depicts that'], prompt_ensembling=False, use_memory=True, memory_id='coco', memory_caption_path='data/memory/coco/memory_captions.json', memory_caption_num=5, img_path='./image_example', output_path='./outputs', vl_model='./checkpoints/HuggingFace/clip-vit-base-patch32', parser_checkpoint='./checkpoints/HuggingFace/flan-t5-base-VG-factual-sg', wte_model_path='./checkpoints/HuggingFace/all-MiniLM-L6-v2', lm_model_path='./checkpoints/CBART_COCO', bart='large', refinement_steps=10, adaptive=False, max_refinement_steps=30, max_len=20, min_len=10, temperature=1, repetition_penalty=2, threshold=0, top_k=0, top_p=0.9, decoder_chain=1, do_sample=0, encoder_loss_type=0, insert_mode=0, max_insert_label=1, num_labels=3, generate_mode=0, full_mask=0, w=1.0)
2024-12-12 11:29:15,194 -  INFO: Load BartForTextInfill from the checkpoint ./checkpoints/CBART_COCO.
2024-12-12 11:29:17,411 -  INFO: Load CLIP from the checkpoint ./checkpoints/HuggingFace/clip-vit-base-patch32.
2024-12-12 11:37:36,280 -  INFO: The log file is ./outputs/MeaCap_image_example_memory_coco_lmTrainingCorpus_CBART_COCO_0.1_0.8_0.2_k200.log
2024-12-12 11:37:36,280 -  INFO: Namespace(seed=0, gpu='0', batch_size=1, conzic_sample=True, conzic_top_k=200, alpha=0.1, beta=0.8, gamma=0.2, use_prompt=False, prompt=['The image depicts that'], prompt_ensembling=False, use_memory=True, memory_id='coco', memory_caption_path='data/memory/coco/memory_captions.json', memory_caption_num=5, img_path='./image_example', output_path='./outputs', vl_model='./checkpoints/HuggingFace/clip-vit-base-patch32', parser_checkpoint='./checkpoints/HuggingFace/flan-t5-base-VG-factual-sg', wte_model_path='./checkpoints/HuggingFace/all-MiniLM-L6-v2', lm_model_path='./checkpoints/CBART_COCO', bart='large', refinement_steps=10, adaptive=False, max_refinement_steps=30, max_len=20, min_len=10, temperature=1, repetition_penalty=2, threshold=0, top_k=0, top_p=0.9, decoder_chain=1, do_sample=0, encoder_loss_type=0, insert_mode=0, max_insert_label=1, num_labels=3, generate_mode=0, full_mask=0, w=1.0)
2024-12-12 11:37:55,573 -  INFO: Load BartForTextInfill from the checkpoint ./checkpoints/CBART_COCO.
2024-12-12 11:37:58,035 -  INFO: Load CLIP from the checkpoint ./checkpoints/HuggingFace/clip-vit-base-patch32.
2024-12-12 11:37:58,228 -  INFO: Load sentenceBERT from the checkpoint ./checkpoints/HuggingFace/all-MiniLM-L6-v2.
2024-12-12 11:38:00,555 -  INFO: Load Textual Scene Graph parser from the checkpoint ./checkpoints/HuggingFace/flan-t5-base-VG-factual-sg.
2024-12-12 11:38:21,754 -  INFO: 1/4, image name: spider_man.jpg
2024-12-12 11:38:25,838 -  INFO: ********************************************
2024-12-12 11:38:25,839 -  INFO: Memory captions: [' a person wearing a spiderman whole-head mask, sitting on a bench with his foot on his knee and holding a cell phone in hand.', 'A white spider man frisbee is in a pond.', 'A person whose feet are perched on a table is in a living room.', 'There is a man with glasses that is letting a spider crawl on his arm.', 'A man\'s legs are laying on a bed as he watches a game called "avengers" on the screen.']
2024-12-12 11:38:25,839 -  INFO: Memory scene graphs: ['( person , wear , mask ) , ( person , sit on , bench ) , ( person , have , foot ) , ( cellphone , in , hand ) , ( foot , on , knee ) , ( person , have , knee ) , ( person , have , head ) , ( head , is , spiderman )', '( frisbee , is , white ) , ( frisbee , in , pond ) , ( spider man , have , frisbee )', '( person , have , feet ) , ( feet , perch on , table ) , ( person , in , living room )', '( spider , crawl on , arm ) , ( man , have , arm ) , ( man , wear , glasses )', '( man , have , legs ) , ( man , watch , game ) , ( game , on , screen ) , ( legs , lay on , bed ) , ( legs , is , 2 )']
2024-12-12 11:38:25,839 -  INFO: Memory concepts: ['foot']
2024-12-12 11:38:25,839 -  INFO: ********************************************
2024-12-12 11:38:25,839 -  INFO:    Now input is: ['foot'] 
2024-12-12 11:38:31,640 -  INFO:    Now result is: A person that is standing with one foot on a skateboard. 
2024-12-12 11:38:31,641 -  INFO: Best shuffle results: A person that is standing with one foot on a skateboard.
2024-12-12 11:38:31,641 -  INFO: using 9.886670351028442s
2024-12-12 11:38:31,671 -  INFO: 2/4, image name: COCO_val2014_000000033645.jpg
2024-12-12 11:38:34,130 -  INFO: ********************************************
2024-12-12 11:38:34,130 -  INFO: Memory captions: ['A young child in sunglasses kicking a ball in a yard with dead grass.', 'A young girl tossing a red and blue frisbee.', 'A small girl plays with a soccer ball in the yard.', 'A girl wearing sunglasses playing baseball in the backyard.', 'A small girl with sunglasses is hitting a tennis ball.']
2024-12-12 11:38:34,130 -  INFO: Memory scene graphs: ['( child , kick , ball ) , ( child , in , yard ) , ( grass , is , dead ) , ( child , is , young ) , ( child , in , sunglasses )', '( girl , throw , frisbee ) , ( girl , is , young ) , ( frisbee , is , red ) , ( frisbee , is , blue )', '( girl , is , small ) , ( girl , play with , soccer ball ) , ( girl , play in , yard )', '( girl , play , baseball ) , ( girl , in , backyard ) , ( girl , wear , sunglasses )', '( girl , hit , tennis ball ) , ( girl , is , small ) , ( girl , with , sunglasses )']
2024-12-12 11:38:34,131 -  INFO: Memory concepts: ['girl', 'sunglasses', 'ball', 'yard']
2024-12-12 11:38:34,131 -  INFO: ********************************************
2024-12-12 11:38:34,132 -  INFO:    Now input is: ['girl sunglasses ball yard'] 
2024-12-12 11:38:36,623 -  INFO:    Now result is: A girl in sunglasses kicking a ball in the yard with grass. 
2024-12-12 11:38:36,623 -  INFO: Best shuffle results: A girl in sunglasses kicking a ball in the yard with grass.
2024-12-12 11:38:36,623 -  INFO: using 4.952180862426758s
2024-12-12 11:38:36,653 -  INFO: 3/4, image name: COCO_val2014_000000078707.jpg
2024-12-12 11:38:37,366 -  INFO: ********************************************
2024-12-12 11:38:37,366 -  INFO: Memory captions: ['An african-american male wearing a baseball uniform preparing to hit a ball.', 'The baseball batter in the maroon helmet and jersey is swinging at a pitch.', 'A baseball player about to swing at the ball and the catcher behind him ready to catch.', 'A baseball player with the a 29 jersey number swings at a pitch.', 'A batter after he has hit a pitched ball before he is going to run.']
2024-12-12 11:38:37,366 -  INFO: Memory scene graphs: ['( male , is , african-american ) , ( male , wear , uniform ) , ( male , hit , ball )', '( baseball batter , wear , helmet ) , ( baseball batter , wear , jersey ) , ( baseball batter , swing at , pitch ) , ( helmet , is , maroon )', '( baseball player , swing at , ball ) , ( catcher , behind , baseball player )', '( number , is , 29 ) , ( baseball player , swing at , pitch ) , ( baseball player , wear , jersey ) , ( jersey , have , number )', '( ball , is , pitched ) , ( batter , hit , ball ) , ( batter , is , running )']
2024-12-12 11:38:37,366 -  INFO: Memory concepts: ['baseball player', 'ball']
2024-12-12 11:38:37,366 -  INFO: ********************************************
2024-12-12 11:38:37,368 -  INFO:    Now input is: ['baseball player ball'] 
2024-12-12 11:38:40,724 -  INFO:    Now result is: A baseball player at bat during which he pitches a ball to another person. 
2024-12-12 11:38:40,724 -  INFO: Best shuffle results: A baseball player at bat during which he pitches a ball to another person.
2024-12-12 11:38:40,724 -  INFO: using 4.070958137512207s
2024-12-12 11:38:40,755 -  INFO: 4/4, image name: COCO_val2014_000000027440.jpg
2024-12-12 11:38:41,537 -  INFO: ********************************************
2024-12-12 11:38:41,537 -  INFO: Memory captions: ['A large giraffe standing next to a brown and white building.', 'A giraffe standing in front of a building with a doorway.', 'A giraffe stands near a white and green trimmed building and the building has an open door.', 'A giraffe stands in  a zoo enclosure next to a building.', 'Several giraffe in an enclosed area with a wooden wall and building area on one side.']
2024-12-12 11:38:41,537 -  INFO: Memory scene graphs: ['( building , is , white ) , ( giraffe , stand next to , building ) , ( building , is , brown ) , ( giraffe , is , large )', '( giraffe , stand in front of , building ) , ( building , with , doorway )', '( giraffe , stand near , building ) , ( building , is , white ) , ( building , have , door ) , ( building , is , green trimmed )', '( giraffe , stand in , zoo enclosure ) , ( zoo enclosure , next to , building )', '( giraffe , in , area ) , ( area , is , enclosed ) , ( wall , is , wooden ) , ( area , with , building ) , ( area , with , wall )']
2024-12-12 11:38:41,537 -  INFO: Memory concepts: ['giraffe', 'building']
2024-12-12 11:38:41,537 -  INFO: ********************************************
2024-12-12 11:38:41,538 -  INFO:    Now input is: ['giraffe building'] 
2024-12-12 11:38:44,113 -  INFO:    Now result is: A giraffe standing next to an old building with a doorway. 
2024-12-12 11:38:44,113 -  INFO: Best shuffle results: A giraffe standing next to an old building with a doorway.
2024-12-12 11:38:44,113 -  INFO: using 3.357698440551758s
